---
title: "Verbrauchs- und Leistungsanalyse: mtcars"
author: "Janka Schultze"
date: "2025-07-07"
output:
  html_document:
    df_print: paged
---
<br>
**Beschreibung:** Der Datensatz `mtcars` enthält Daten zu 32 Autos, u.a. Zylinderanzahl (cyl), Motorleistung (hp), Kraftstoffverbrauch (mpg), Gewicht (wt), Beschleunigungszeit (qsec) und Getriebeart (am).  

In dieser Analyse werden folgende Fragestellungen untersucht:

- Verteilung der Zylinderanzahl  
- Lagemaße (Mittelwert, Median, Modus) und Streuungsmaße (Varianz, Standardabweichung, Spannweite, IQR) des Kraftstoffverbrauchs  
- Kreuztabellen zur Beziehung zwischen Zylinderanzahl und Getriebeart  
- Visualisierung der Zylinderverteilung (Balkendiagramm)  
- Boxplot des Kraftstoffverbrauchs nach Zylinderanzahl  
- Boxplot des Kraftstoffverbrauchs nach Getriebeart (Automatik vs. Schaltung)  
- Scatterplot von Verbrauch vs. Gewicht, farblich nach Zylinderanzahl   
- Scatterplot von Verbrauch vs. Gewicht facettiert nach Getriebeart  
- Zusammenhang von Verbrauch und Motorleistung  
- Paarweise Zusammenhänge zwischen Kraftstoffverbrauch (mpg),
Motorleistung (hp), Gewicht (wt) und Beschleunigung (qsec)
- Korrelationsmatrix (Heatmap) mit Kraftstoffverbrauch, Motorleistung, Gewicht und Beschleunigung
 

**Ziel:** Identifikation von Mustern, Zusammenhängen und Einflussfaktoren auf den Kraftstoffverbrauch, um die Daten explorativ, statistisch und visuell professionell zu analysieren.  
<br>

#### Bibliotheken
```{r}
# Prüfe und installiere benötigte Pakete automatisch
packages <- c("tidyverse", "GGally")

installed <- packages %in% rownames(installed.packages())
if (any(!installed)) {
  install.packages(packages[!installed])
}

# Lade Pakete
library(tidyverse)
library(GGally)

```
<br>

#### Überblick über den Datensatz
```{r}
# Zeige die ersten Zeilen
head(mtcars)

# Struktur und Variablen prüfen
str(mtcars)
```
<br>

#### Häufigkeitsverteilungen
```{r}
# Häufigkeitstabelle der Zylinderanzahl (Base R)
zylinder_tabelle <- table(mtcars$cyl)
print(zylinder_tabelle)

# Relative Häufigkeit in Prozent

prop.table(zylinder_tabelle) * 100

# Alternative mit dplyr

mtcars %>% count(cyl) %>% mutate(anteil = n / sum(n) * 100)
```
<br>

#### Lagemaße des Kraftstoffverbrauchs
```{r}
# Mittelwert und Median berechnen (mpg)
mean(mtcars$mpg)
median(mtcars$mpg)

# Modus berechnen (häufigster Wert)
modus_tabelle <- table(mtcars$mpg)
names(modus_tabelle)[which.max(modus_tabelle)]
```
<br>

#### Streuungsmaße
```{r}
# Varianz
var(mtcars$mpg)

# Standardabweichung
sd(mtcars$mpg)  

# Spannweite (min, max)
range(mtcars$mpg)    

# Spannweite als Differenz
diff(range(mtcars$mpg)) 

# Quantile und Interquartilsabstand
quantile(mtcars$mpg)
IQR(mtcars$mpg)
```
<br>

#### Kreuztabellen
```{r}
# Beziehung zwischen Zylinderanzahl und Getriebeart

# Kreuztabelle von Zylindern und Getriebetyp
kreuztabelle <- table(mtcars$cyl, mtcars$am)
print(kreuztabelle)

# Alternative mit dplyr
mtcars %>% count(cyl, am)
```
<br>

#### Visualisierungen
```{r}
# Balkendiagramm: Häufigkeit der Zylinderanzahl
ggplot(mtcars, aes(x = factor(cyl))) +
  geom_bar(fill = "steelblue") +
  labs(
    title = "Häufigkeit der Zylinderanzahl",
    x = "Zylinder",
    y = "Anzahl der Autos"
  ) +
  theme_minimal()
```

<br>


```{r}
# Boxplot: Kraftstoffverbrauch (mpg) nach Zylinderanzahl
ggplot(mtcars, aes(x = factor(cyl), y = mpg, fill = factor(cyl))) +
  geom_boxplot() +
  labs(
    title = "Kraftstoffverbrauch nach Zylinderanzahl",
    x = "Zylinder",
    y = "Kraftstoffverbrauch"
  ) +
  theme_minimal() +
  theme(legend.position = "none")
```

<br>

```{r}
# Boxplot: Kraftstoffverbrauch nach Getriebeart
ggplot(mtcars, aes(x = factor(am), y = mpg, fill = factor(am))) +
  geom_boxplot() +
  labs(
    title = "Kraftstoffverbrauch nach Getriebeart",
    x = "Getriebeart (0 = Automatik, 1 = Schaltgetriebe)",
    y = "Kraftstoffverbrauch"
  ) +
  theme_minimal() +
  theme(legend.position = "none")

```

<br>

```{r}
# Scatterplot: mpg vs. Gewicht (wt), farblich nach Zylinder
ggplot(mtcars, aes(x = wt, y = mpg, color = factor(cyl))) +
  geom_point(size = 3) +
  labs(
    title = "Verbrauch vs. Gewicht nach Zylinderanzahl",
    x = "Gewicht (1000 lbs)",
    y = "Kraftstoffverbrauch",
    color = "Zylinder"
  ) + 
  theme_minimal()
```

<br>


```{r}
# Scatterplot mit Facetten nach Getriebeart (am)
ggplot(mtcars, aes(x = wt, y = mpg, color = factor(cyl))) +
  geom_point(size = 3) +
  facet_wrap(~ am, labeller = as_labeller(c(`0` = "Automatik", `1` = "Schaltgetriebe"))) +
  labs(
    title = "Verbrauch vs. Gewicht nach Zylinderanzahl und Getriebeart",
    x = "Gewicht (1000 lbs)",
    y = "Kraftstoffverbrauch",
    color = "Zylinder"
  ) +
  theme_minimal()
```

<br>
```{r}
# Scatterplot: Motorleistung (hp) vs. Verbrauch (mpg)
ggplot(mtcars, aes(x = hp, y = mpg, color = factor(cyl))) +
  geom_point(size = 3) +
  geom_smooth(method = "lm", se = FALSE, linetype = "dashed") +
  labs(
    title = "Kraftstoffverbrauch vs. Motorleistung",
    x = "Motorleistung (hp)", 
    y = "Kraftstoffverbrauch",
    color = "Zylinder"
  ) +
  theme_minimal()

```

<br>
```{r}
# Gewicht vs. Beschleunigung (Viertelmeile, qsec)
ggplot(mtcars, aes(x = wt, y = qsec, color = factor(cyl))) +
geom_point(size = 3) +
geom_smooth(method = "lm", se = FALSE, linetype = "dotted") +
labs(
title = "Beschleunigung (Viertelmeile) vs. Gewicht",
x = "Gewicht (1000 lbs)",
y = "Beschleunigungszeit qsec",
color = "Zylinder"
) +
theme_minimal()
```


<br>

```{r}
library(ggplot2)
library(dplyr)
library(patchwork)

# mtcars vorbereiten
mtcars2 <- mtcars %>% 
  mutate(cyl = factor(cyl))

# Farben für Zylinder
zylinder_colors <- c("4" = "#66c2a5", "6" = "#fc8d62", "8" = "#8da0cb")

# Einzelplots erstellen
p1 <- ggplot(mtcars2, aes(x=mpg, y=hp, color=cyl)) +
  geom_point(size=3) +
  scale_color_manual(values=zylinder_colors, name="Zylinder") +
  theme_minimal() +
  labs(x="mpg", y="hp")

p2 <- ggplot(mtcars2, aes(x=mpg, y=wt, color=cyl)) +
  geom_point(size=3) +
  scale_color_manual(values=zylinder_colors, name="Zylinder") +
  theme_minimal() +
  labs(x="mpg", y="wt")

p3 <- ggplot(mtcars2, aes(x=mpg, y=qsec, color=cyl)) +
  geom_point(size=3) +
  scale_color_manual(values=zylinder_colors, name="Zylinder") +
  theme_minimal() +
  labs(x="mpg", y="qsec")

p4 <- ggplot(mtcars2, aes(x=hp, y=wt, color=cyl)) +
  geom_point(size=3) +
  scale_color_manual(values=zylinder_colors, name="Zylinder") +
  theme_minimal() +
  labs(x="hp", y="wt")

# Matrix zusammenfügen (2x2)
(p1 | p2) / (p3 | p4) +
  plot_annotation(
    title = "Paarweise Zusammenhänge zwischen Kraftstoffverbrauch (mpg),\nMotorleistung (hp), Gewicht (wt) und Beschleunigung (qsec)"
  )


```

<br>

```{r}
library(dplyr)
library(ggplot2)
library(reshape2)

# mtcars vorbereiten
mtcars2 <- mtcars %>% 
  mutate(
    cyl = factor(cyl),
    am = factor(am, labels = c("Automatik", "Manuell"))
  )

# Wichtige Variablen auswählen
vars <- c("mpg", "hp", "wt", "qsec")

# Korrelationsmatrix
cor_mat <- cor(mtcars2[, vars])

# In long format für ggplot umwandeln
cor_long <- melt(cor_mat)

# Heatmap erstellen
ggplot(cor_long, aes(Var1, Var2, fill = value)) +
  geom_tile(color = "white") +
  scale_fill_gradient2(low = "blue", mid = "white", high = "red", midpoint = 0,
                       limits = c(-1,1), name = "Korrelation") +
  geom_text(aes(label = round(value, 2)), color = "black", size = 4) +
  theme_minimal() +
  labs(
    title = "Korrelationen im mtcars-Datensatz",
    subtitle = "Kraftstoffverbrauch (mpg), Motorleistung (hp), Gewicht (wt), Beschleunigung (qsec)",
    x = NULL,
    y = NULL
  ) +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

```

<br>

### Zusammenfassung & Insights

Die explorative Analyse des Datensatzes `mtcars` zeigt deutliche Muster und Zusammenhänge zwischen Verbrauch, Motorleistung, Gewicht, Zylinderzahl und Getriebeart.  

**Zylinder und Verbrauch:**  
- Fahrzeuge mit mehr Zylindern (6 oder 8) zeigen einen deutlich höheren Kraftstoffverbrauch als 4-Zylinder-Modelle.  
- Die Varianz des Verbrauchs steigt mit der Zylinderzahl – große Motoren unterscheiden sich stärker in ihrer Effizienz.  

**Gewicht und Verbrauch:**  
- Zwischen Fahrzeuggewicht und Verbrauch besteht eine starke negative Korrelation: leichtere Autos verbrauchen weniger.  
- Der Scatterplot zeigt eine klare Abnahme des mpg-Werts mit steigendem Gewicht – insbesondere bei 8-Zylinder-Autos.  

**Motorleistung:**  
- Höhere Motorleistung (hp) geht mit geringerem Kraftstoffverbrauch (mpg) einher.  
- Die lineare Trendlinie bestätigt einen deutlichen negativen Zusammenhang.  
- Leistungsstarke Fahrzeuge (über 200 PS) liegen fast ausschließlich im unteren Effizienzbereich (< 20 mpg).  

**Beschleunigung:**  
- Schwerere Fahrzeuge benötigen mehr Zeit für die Viertelmeile (qsec), was auf eine erwartbare negative Beziehung zwischen Gewicht und Beschleunigung hinweist.  
- 4-Zylinder-Autos beschleunigen im Verhältnis zu ihrem Gewicht effizienter.  

**Getriebearten:**  
- Schaltgetriebene Fahrzeuge (am = 1) erreichen tendenziell bessere Verbrauchswerte als Automatikfahrzeuge.  
- Besonders 4-Zylinder-Schaltwagen kombinieren niedrigen Verbrauch mit guter Beschleunigung.  

**Korrelationen:**  
- mpg korreliert stark negativ mit hp (Motorleistung) und wt (Gewicht).  
- Zwischen hp und wt besteht eine positive Korrelation: leistungsstärkere Autos sind oft schwerer.  
- qsec korreliert schwach negativ mit wt, was eine längere Beschleunigungszeit bei höherem Gewicht bestätigt.  

**Zylinder und Getriebe:**  
- 8-Zylinder-Modelle sind überwiegend mit Automatik ausgestattet, während 4-Zylinder häufiger mit Schaltgetriebe vorkommen.  
- Dies deutet auf unterschiedliche Fahrzeugsegmente hin: sportliche oder kompakte Modelle mit Schaltung vs. große, komfortorientierte Fahrzeuge mit Automatik.  

**Gesamtfazit:**  
Der Kraftstoffverbrauch wird im Wesentlichen durch diese drei Faktoren bestimmt. Die Variablen sind stark miteinander verknüpft und bilden die Grundlage für eine effiziente Fahrzeugklassifikation:  
- Motorgröße und Leistung  
- Fahrzeuggewicht  
- Getriebeart   

 

